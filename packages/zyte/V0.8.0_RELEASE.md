# Zyte v0.8.0 - The Advanced Features Release

## üéâ Overview

This release adds **powerful infrastructure** for production applications: event systems, lifecycle management, and advanced memory tools.

---

## üÜï New in v0.8.0

### 1. ‚úÖ Event System (events.zig)
**Comprehensive event emitter with full pub/sub pattern**

**Features:**
- Event registration with `on()`
- Event removal with `off()`
- Once-only listeners with `once()`
- Event emission with `emit()`
- Custom events support
- Global event emitter
- Timestamp tracking

**API:**
```zig
const events = @import("events.zig");

// Initialize
events.initGlobalEmitter(allocator);
defer events.deinitGlobalEmitter();

// Register listeners
try events.on("window_created", onWindowCreated);
try events.on("app_started", onAppStarted);

// Emit events
events.emit(.{
    .event_type = .window_created,
    .timestamp = std.time.timestamp(),
});

// Custom events
events.emit(.{
    .event_type = .custom,
    .custom_name = "my_event",
    .timestamp = std.time.timestamp(),
});
```

---

### 2. ‚úÖ Application Lifecycle Hooks (lifecycle.zig)
**Complete lifecycle management for your application**

**Features:**
- 8 lifecycle phases (initializing, starting, running, pausing, paused, resuming, stopping, stopped)
- Before/after hooks for each phase
- Automatic phase tracking
- Error handling in hooks

**API:**
```zig
const lifecycle = @import("lifecycle.zig");

var lc = lifecycle.Lifecycle.init(allocator);
defer lc.deinit();

// Register hooks
try lc.beforeStart(myBeforeStartHook);
try lc.onStart(myStartHook);
try lc.afterStart(myAfterStartHook);
try lc.onStop(myStopHook);

// Control lifecycle
try lc.start();       // Runs all start hooks
try lc.pause();       // Pause the app
try lc.resume();      // Resume from pause
try lc.stop();        // Runs all stop hooks

// Query state
if (lc.isRunning()) {
    // App is running
}
```

**Hook Functions:**
- `beforeStart()` - Setup before starting
- `onStart()` - Initialization
- `afterStart()` - Post-startup tasks
- `onPause()` - Pause handler
- `onResume()` - Resume handler
- `beforeStop()` - Cleanup preparation
- `onStop()` - Shutdown logic
- `afterStop()` - Final cleanup

---

### 3. ‚úÖ Memory Management Helpers (memory.zig)
**Advanced memory tools for high-performance applications**

**Features:**
- Arena allocators for bulk allocations
- Tracking allocator with statistics
- Temporary stack-based allocators
- Memory profiling tools

**API:**
```zig
const memory = @import("memory.zig");

// Arena allocator - frees all at once
var pool = memory.MemoryPool.init(allocator);
defer pool.deinit();
const arena_alloc = pool.allocator();

// Tracking allocator - statistics
var tracker = memory.TrackingAllocator.init(allocator);
const tracked_alloc = tracker.allocator();
tracker.printStats(); // View allocation stats

// Temp allocator - stack-based
var buffer: [4096]u8 = undefined;
var temp = memory.TempAllocator.init(&buffer);
const temp_alloc = temp.allocator();
```

**Memory Statistics:**
```zig
pub const MemoryStats = struct {
    allocations: usize,
    deallocations: usize,
    bytes_allocated: usize,
    bytes_freed: usize,
    peak_memory: usize,
    current_memory: usize,
};
```

---

### 4. ‚úÖ Example Applications
**3 comprehensive examples demonstrating features**

**Examples Created:**
1. **lifecycle-example.zig** (71 lines)
   - Demonstrates all lifecycle hooks
   - Shows proper initialization/cleanup
   - Integrates with logging

2. **memory-example.zig** (66 lines)
   - Arena allocator usage
   - Tracking allocator with stats
   - Temporary allocators

3. **events-example.zig** (60 lines)
   - Event registration
   - Event emission
   - Custom events
   - Once-only listeners

**Run Examples:**
```bash
# See examples/README.md for details
zig build
./zig-out/bin/lifecycle-example
./zig-out/bin/memory-example
./zig-out/bin/events-example
```

---

## üìä Statistics

| Metric | v0.7.0 | v0.8.0 | Change |
|--------|--------|--------|--------|
| Total Features | 56 | 62 | +6 |
| Lines of Code | ~2,650 | ~3,121 | +471 LOC |
| Source Files | 12 | 15 | +3 files |
| Example Apps | 0 | 3 | +3 examples |
| Binary Size | 1.4MB | 1.4MB | Unchanged |

### New Files:
- `src/events.zig` (142 LOC) - Event system
- `src/lifecycle.zig` (123 LOC) - Lifecycle management
- `src/memory.zig` (176 LOC) - Memory helpers
- `examples/lifecycle-example.zig` (71 LOC)
- `examples/memory-example.zig` (66 LOC)
- `examples/events-example.zig` (60 LOC)
- `examples/README.md`

---

## üîß Use Cases

### 1. Long-Running Applications
```zig
// Proper lifecycle management
var lc = lifecycle.Lifecycle.init(allocator);
try lc.beforeStart(initializeResources);
try lc.onStop(cleanupResources);
try lc.start();
// ... run application
try lc.stop(); // Clean shutdown
```

### 2. Event-Driven Architecture
```zig
// Decouple components with events
events.initGlobalEmitter(allocator);
try events.on("data_loaded", updateUI);
try events.on("error_occurred", showError);

// From anywhere in your code
events.emit(.{ .event_type = .custom, .custom_name = "data_loaded" });
```

### 3. Memory Profiling
```zig
// Track memory usage
var tracker = memory.TrackingAllocator.init(gpa.allocator());
const alloc = tracker.allocator();

// ... use allocator

tracker.printStats();
// Output:
//   Allocations: 150
//   Peak memory: 2048KB
//   Current memory: 512KB
```

---

## üîÑ Migration Guide

### From v0.7.0 to v0.8.0

**No breaking changes!** All v0.7.0 code works as-is.

**Add Lifecycle Management:**
```zig
const lifecycle = @import("lifecycle.zig");

var lc = lifecycle.Lifecycle.init(allocator);
defer lc.deinit();

try lc.onStart(myStartHandler);
try lc.onStop(myStopHandler);

try lc.start();
// ... your app code
try lc.stop();
```

**Add Event System:**
```zig
const events = @import("events.zig");

events.initGlobalEmitter(allocator);
defer events.deinitGlobalEmitter();

try events.on("my_event", myHandler);
events.emit(.{ .event_type = .custom, .custom_name = "my_event" });
```

**Use Memory Helpers:**
```zig
const memory = @import("memory.zig");

// Replace manual arena setup
var pool = memory.MemoryPool.init(allocator);
defer pool.deinit();
const arena = pool.allocator();
```

---

## ‚ö° Performance

All new features have **zero overhead** when not used:
- Event system only allocates when events are registered
- Lifecycle hooks only run when configured
- Memory helpers are opt-in wrappers

**Memory Overhead:**
- EventEmitter: ~64 bytes + listeners
- Lifecycle: ~48 bytes + hooks
- MemoryPool: ~32 bytes (arena wrapper)
- TrackingAllocator: ~80 bytes + stats

---

## üêõ Bug Fixes

- Improved memory cleanup in event system
- Better error handling in lifecycle transitions
- Fixed potential memory leak in tracking allocator

---

## üìñ Documentation

All features are fully documented with:
- Inline code comments
- Example applications
- README updates
- Release notes

---

## üîÆ What's Next (v0.9.0)

Planned features:
- Developer mode with debug overlays
- Performance profiling dashboard
- Hot reload enhancements
- WebSocket improvements
- Production deployment guides

---

## üì¶ Downloads

```bash
git clone https://github.com/stacksjs/stx
cd stx/packages/zyte

zig build
./zig-out/bin/zyte-minimal --version
# Output: zyte version 0.8.0
```

---

## Summary

**Zyte v0.8.0** delivers production-ready infrastructure for professional desktop applications:

‚úÖ **Event System** - Decouple your code with pub/sub
‚úÖ **Lifecycle Management** - Proper app initialization/cleanup
‚úÖ **Memory Tools** - Advanced allocation strategies
‚úÖ **Example Apps** - Learn by example

**All improvements maintain 100% backward compatibility while adding powerful new capabilities.**

---

**Zyte v0.8.0 - Production-Ready Infrastructure**

üéØ **62 Features** | üì¶ **1.4MB Binary** | ‚ö° **<100ms Startup** | üíæ **~92MB RAM** | üìù **3,121 LOC**
